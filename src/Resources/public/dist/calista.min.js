(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=20)})([function(a){var b=a.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=b)},function(a,b,c){var d=c(23)('wks'),e=c(11),f=c(0).Symbol,g='function'==typeof f,h=a.exports=function(a){return d[a]||(d[a]=g&&f[a]||(g?f:e)('Symbol.'+a))};h.store=d},function(a,b,c){var d=c(3);a.exports=function(a){if(!d(a))throw TypeError(a+' is not an object!');return a}},function(a){a.exports=function(a){return'object'==typeof a?null!==a:'function'==typeof a}},function(a,b,c){var d=c(5);a.exports=function(e,f,a){return(d(e),void 0===f)?e:1===a?function(b){return e.call(f,b)}:2===a?function(c,a){return e.call(f,c,a)}:3===a?function(d,a,b){return e.call(f,d,a,b)}:function(){return e.apply(f,arguments)}}},function(a){a.exports=function(a){if('function'!=typeof a)throw TypeError(a+' is not a function!');return a}},function(a){var b=a.exports={version:'2.5.3'};'number'==typeof __e&&(__e=b)},function(a,b,c){a.exports=!c(13)(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7}}).a})},function(a){var b={}.toString;a.exports=function(a){return b.call(a).slice(8,-1)}},function(a,b,c){var d=c(2),e=c(25),f=c(26),g=Object.defineProperty;b.f=c(7)?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(a){}if('get'in c||'set'in c)throw TypeError('Accessors not supported!');return'value'in c&&(a[b]=c.value),a}},function(a,b,c){var d=c(8),e=c(1)('toStringTag'),f='Arguments'==d(function(){return arguments}()),g=function(a,b){try{return a[b]}catch(a){}};a.exports=function(a){var b,c,h;return a===void 0?'Undefined':null===a?'Null':'string'==typeof(c=g(b=Object(a),e))?c:f?d(b):'Object'==(h=d(b))&&'function'==typeof b.callee?'Arguments':h}},function(a){var b=0,c=Math.random();a.exports=function(a){return'Symbol('.concat(a===void 0?'':a,')_',(++b+c).toString(36))}},function(a,b,c){var d=c(9),e=c(27);a.exports=c(7)?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},function(a){a.exports=function(a){try{return!!a()}catch(a){return!0}}},function(a,b,c){var d=c(3),e=c(0).document,f=d(e)&&d(e.createElement);a.exports=function(a){return f?e.createElement(a):{}}},function(a,b,c){var d=c(0),e=c(12),f=c(16),g=c(11)('src'),h='toString',i=Function[h],j=(''+i).split(h);c(6).inspectSource=function(a){return i.call(a)},(a.exports=function(a,b,c,h){var i='function'==typeof c;i&&(f(c,'name')||e(c,'name',b));a[b]===c||(i&&(f(c,g)||e(c,g,a[b]?''+a[b]:j.join(b+''))),a===d?a[b]=c:h?a[b]?a[b]=c:e(a,b,c):(delete a[b],e(a,b,c)))})(Function.prototype,h,function(){return'function'==typeof this&&this[g]||i.call(this)})},function(a){var b={}.hasOwnProperty;a.exports=function(a,c){return b.call(a,c)}},function(a){a.exports={}},function(a,b,c){var d,e,f,g=c(4),h=c(36),i=c(37),j=c(14),k=c(0),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=k.Dispatch,q=0,r={},s='onreadystatechange',t=function(){var a=+this;if(r.hasOwnProperty(a)){var b=r[a];delete r[a],b()}},u=function(a){t.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return r[++q]=function(){h('function'==typeof a?a:Function(a),b)},d(q),q},n=function(a){delete r[a]},'process'==c(8)(l)?d=function(a){l.nextTick(g(t,a,1))}:p&&p.now?d=function(a){p.now(g(t,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=u,d=g(f.postMessage,f,1)):k.addEventListener&&'function'==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+'','*')},k.addEventListener('message',u,!1)):s in j('script')?d=function(a){i.appendChild(j('script'))[s]=function(){i.removeChild(this),t.call(a)}}:d=function(a){setTimeout(g(t,a,1),0)}),a.exports={set:m,clear:n}},function(a,b,c){'use strict';function d(a){var b,c;this.promise=new a(function(a,d){if(b!=void 0||c!=void 0)throw TypeError('Bad Promise constructor');b=a,c=d}),this.resolve=e(b),this.reject=e(c)}var e=c(5);a.exports.f=function(a){return new d(a)}},function(a,b,c){c(21),a.exports=c(45)},function(a,b,c){'use strict';var d,e,f,g,h=c(22),i=c(0),j=c(4),k=c(10),l=c(24),m=c(3),n=c(5),o=c(28),p=c(29),q=c(35),r=c(18).set,s=c(38)(),t=c(19),u=c(39),v=c(40),w='Promise',x=i.TypeError,y=i.process,z=i[w],A='process'==k(y),B=function(){},D=e=t.f,C=!!function(){try{var a=z.resolve(1),b=(a.constructor={})[c(1)('species')]=function(a){a(B,B)};return(A||'function'==typeof PromiseRejectionEvent)&&a.then(B)instanceof b}catch(a){}}(),E=function(a){var b;return m(a)&&'function'==typeof(b=a.then)&&b},F=function(a,b){if(!a._n){a._n=!0;var c=a._c;s(function(){for(var d=a._v,e=1==a._s,f=0,g=function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(!e&&(2==a._h&&I(a),a._h=1),!0===g?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(x('Promise-chain cycle')):(f=E(c))?f.call(c,h,i):h(c)):i(d)}catch(a){i(a)}};c.length>f;)g(c[f++]);a._c=[],a._n=!1,b&&!a._h&&G(a)})}},G=function(a){r.call(i,function(){var b,c,d,e=a._v,f=H(a);if(f&&(b=u(function(){A?y.emit('unhandledRejection',e,a):(c=i.onunhandledrejection)?c({promise:a,reason:e}):(d=i.console)&&d.error&&d.error('Unhandled promise rejection',e)}),a._h=A||H(a)?2:1),a._a=void 0,f&&b.e)throw b.v})},H=function(a){return 1!==a._h&&0===(a._a||a._c).length},I=function(a){r.call(i,function(){var b;A?y.emit('rejectionHandled',a):(b=i.onrejectionhandled)&&b({promise:a,reason:a._v})})},J=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,!b._a&&(b._a=b._c.slice()),F(b,!0))},K=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw x('Promise can\'t be resolved itself');(b=E(a))?s(function(){var d={_w:c,_d:!1};try{b.call(a,j(K,d,1),j(J,d,1))}catch(a){J.call(d,a)}}):(c._v=a,c._s=1,F(c,!1))}catch(a){J.call({_w:c,_d:!1},a)}}};C||(z=function(a){o(this,z,w,'_h'),n(a),d.call(this);try{a(j(K,this,1),j(J,this,1))}catch(a){J.call(this,a)}},d=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},d.prototype=c(41)(z.prototype,{then:function(a,b){var c=D(q(this,z));return c.ok='function'!=typeof a||a,c.fail='function'==typeof b&&b,c.domain=A?y.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&F(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),f=function(){var a=new d;this.promise=a,this.resolve=j(K,a,1),this.reject=j(J,a,1)},t.f=D=function(a){return a===z||a===g?new f(a):e(a)}),l(l.G+l.W+l.F*!C,{Promise:z}),c(42)(z,w),c(43)(w),g=c(6)[w],l(l.S+l.F*!C,w,{reject:function(a){var b=D(this),c=b.reject;return c(a),b.promise}}),l(l.S+l.F*(h||!C),w,{resolve:function(a){return v(h&&this===g?z:this,a)}}),l(l.S+l.F*!(C&&c(44)(function(a){z.all(a)['catch'](B)})),w,{all:function(a){var b=this,c=D(b),d=c.resolve,e=c.reject,f=u(function(){var c=[],f=0,g=1;p(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f.e&&e(f.v),c.promise},race:function(a){var b=this,c=D(b),d=c.reject,e=u(function(){p(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}})},function(a){a.exports=!1},function(a,b,c){var d=c(0),e='__core-js_shared__',f=d[e]||(d[e]={});a.exports=function(a){return f[a]||(f[a]={})}},function(a,b,c){var d=c(0),e=c(6),f=c(12),g=c(15),h=c(4),i='prototype',j=function(a,b,c){var k,l,m,n,o=a&j.F,p=a&j.G,q=a&j.S,r=a&j.P,s=a&j.B,t=p?d:q?d[b]||(d[b]={}):(d[b]||{})[i],u=p?e:e[b]||(e[b]={}),v=u[i]||(u[i]={});for(k in p&&(c=b),c)l=!o&&t&&void 0!==t[k],m=(l?t:c)[k],n=s&&l?h(m,d):r&&'function'==typeof m?h(Function.call,m):m,t&&g(t,k,m,a&j.U),u[k]!=m&&f(u,k,n),r&&v[k]!=m&&(v[k]=m)};d.core=e,j.F=1,j.G=2,j.S=4,j.P=8,j.B=16,j.W=32,j.U=64,j.R=128,a.exports=j},function(a,b,c){a.exports=!c(7)&&!c(13)(function(){return 7!=Object.defineProperty(c(14)('div'),'a',{get:function(){return 7}}).a})},function(a,b,c){var d=c(3);a.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&'function'==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if('function'==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&'function'==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError('Can\'t convert object to primitive value')}},function(a){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},function(a){a.exports=function(a,b,c,d){if(!(a instanceof b)||d!==void 0&&d in a)throw TypeError(c+': incorrect invocation!');return a}},function(a,b,c){var d=c(4),e=c(30),g=c(31),h=c(2),i=c(32),j=c(34),k={},l={},b=a.exports=function(a,b,c,m,n){var o,p,q,r,s=n?function(){return a}:j(a),t=d(c,m,b?2:1),f=0;if('function'!=typeof s)throw TypeError(a+' is not iterable!');if(g(s)){for(o=i(a.length);o>f;f++)if(r=b?t(h(p=a[f])[0],p[1]):t(a[f]),r===k||r===l)return r;}else for(q=s.call(a);!(p=q.next()).done;)if(r=e(q,t,p.value,b),r===k||r===l)return r};b.BREAK=k,b.RETURN=l},function(a,b,c){var d=c(2);a.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(b){var f=a['return'];throw void 0!==f&&d(f.call(a)),b}}},function(a,b,c){var d=c(17),e=c(1)('iterator'),f=Array.prototype;a.exports=function(a){return a!==void 0&&(d.Array===a||f[e]===a)}},function(a,b,c){var d=c(33),e=Math.min;a.exports=function(a){return 0<a?e(d(a),9007199254740991):0}},function(a){var b=Math.ceil,c=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(0<a?c:b)(a)}},function(a,b,c){var d=c(10),e=c(1)('iterator'),f=c(17);a.exports=c(6).getIteratorMethod=function(a){if(a!=void 0)return a[e]||a['@@iterator']||f[d(a)]}},function(a,b,c){var d=c(2),e=c(5),f=c(1)('species');a.exports=function(a,b){var c,g=d(a).constructor;return g===void 0||(c=d(g)[f])==void 0?b:e(c)}},function(a){a.exports=function(a,b,c){var d=c===void 0;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3]);}return a.apply(c,b)}},function(a,b,c){var d=c(0).document;a.exports=d&&d.documentElement},function(a,b,c){var d=c(0),e=c(18).set,f=d.MutationObserver||d.WebKitMutationObserver,g=d.process,h=d.Promise,i='process'==c(8)(g);a.exports=function(){var a,b,c,j=function(){var d,e;for(i&&(d=g.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(d){throw a?c():b=void 0,d}}b=void 0,d&&d.enter()};if(i)c=function(){g.nextTick(j)};else if(f&&!(d.navigator&&d.navigator.standalone)){var k=!0,l=document.createTextNode('');new f(j).observe(l,{characterData:!0}),c=function(){l.data=k=!k}}else if(h&&h.resolve){var m=h.resolve();c=function(){m.then(j)}}else c=function(){e.call(d,j)};return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}}},function(a){a.exports=function(a){try{return{e:!1,v:a()}}catch(a){return{e:!0,v:a}}}},function(a,b,c){var d=c(2),e=c(3),f=c(19);a.exports=function(a,b){if(d(a),e(b)&&b.constructor===a)return b;var c=f.f(a),g=c.resolve;return g(b),c.promise}},function(a,b,c){var d=c(15);a.exports=function(a,b,c){for(var e in b)d(a,e,b[e],c);return a}},function(a,b,c){var d=c(9).f,e=c(16),f=c(1)('toStringTag');a.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})}},function(a,b,c){'use strict';var d=c(0),e=c(9),f=c(7),g=c(1)('species');a.exports=function(a){var b=d[a];f&&b&&!b[g]&&e.f(b,g,{configurable:!0,get:function(){return this}})}},function(a,b,c){var d=c(1)('iterator'),e=!1;try{var f=[7][d]();f['return']=function(){e=!0},Array.from(f,function(){throw 2})}catch(a){}a.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{var f=[7],g=f[d]();g.next=function(){return{done:c=!0}},f[d]=function(){return g},a(f)}catch(a){}return c}},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var d=c(46),e=c.n(d),f=c(47),g=c.n(f)},function(){},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0}),c(48);var d=c(49),e=c(50);if(window.Drupal)Drupal.behaviors.calistaPage={attach:function(a){for(var b,c=0,d=a.querySelectorAll('[data-page]:not([data-page-initialized])');c<d.length;c++)b=d[c],new e.Page(b)}},Drupal.behaviors.calistaPane={attach:function(a){for(var b,c=0,e=a.querySelectorAll('#contextual-pane');c<e.length;c++)b=e[c],new d.Pane(b)}};else{for(var f,g=0,h=document.querySelectorAll('[data-page]:not([data-page-initialized])');g<h.length;g++)f=h[g],new e.Page(f);for(var f,i=0,j=document.querySelectorAll('#contextual-pane');i<j.length;i++)f=j[i],new d.Pane(f)}},function(){'use strict'},function(a,b){'use strict';var c=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d['throw'](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},d=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError('Generator is already executing.');for(;g;)try{if(e=1,f&&(h=f[2&c[0]?'return':c[0]?'throw':'next'])&&!(h=h.call(f,c[1])).done)return h;switch((f=0,h)&&(c=[0,h.value]),c[0]){case 0:case 1:h=c;break;case 4:return g.label++,{value:c[1],done:!1};case 5:g.label++,f=c[1],c=[0];continue;case 7:c=g.ops.pop(),g.trys.pop();continue;default:if((h=g.trys,!(h=0<h.length&&h[h.length-1]))&&(6===c[0]||2===c[0])){g=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3])){g.label=c[1];break}if(6===c[0]&&g.label<h[1]){g.label=h[1],h=c;break}if(h&&g.label<h[2]){g.label=h[2],g.ops.push(c);break}h[2]&&g.ops.pop(),g.trys.pop();continue;}c=b.call(a,g)}catch(a){c=[6,a],f=0}finally{e=h=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,h,i,g={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},'function'==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(b,'__esModule',{value:!0});var e=function(){return function(a,b,c){this.element=a,this.linkElement=b,this.name=c}}(),f=function(){function a(){}return a.prototype.isHidden=function(){return /calista-pane-hidden=1/.test(document.cookie)},a.prototype.hide=function(){document.cookie='calista-pane-hidden=1'},a.prototype.show=function(){document.cookie='calista-pane-hidden=0'},a}(),g=function(){function a(a){var b=this;this.displayed=!0,this.element=a,this.state=new f;var c=a.querySelector('#contextual-pane-toggle a');c.addEventListener('click',function(a){a.stopPropagation(),a.preventDefault(),b.togglePane(),c.blur()}),this.restoreInitialState(),this.refresh();var d=a.getAttribute('data-active-tab')||'';d&&this.toggleTab(d)}return a.prototype.restoreInitialState=function(){return c(this,void 0,void 0,function(){var a=this;return d(this,function(){return this.element.classList.add('initial-collapse'),document.body.classList.add('initial-collapse'),setTimeout(function(){a.element.classList.remove('initial-collapse'),document.body.classList.remove('initial-collapse')},1e3),this.state.isHidden()?(this.displayed=!1,this.element.classList.add('contextual-collapsed'),document.body.classList.remove('calista-body-with-pane')):(this.displayed=!0,this.element.classList.remove('contextual-collapsed'),document.body.classList.add('calista-body-with-pane')),[2]})})},a.prototype.refresh=function(){return c(this,void 0,void 0,function(){var a,b,c,f,g,h=this;return d(this,function(){for(this.tabs=[],a=function(a){var c=a.getAttribute('data-tab-toggle')||'',d=b.element.querySelector('[data-tab='+c+']');return d?void(b.tabs.push(new e(d,a,c)),a.addEventListener('click',function(a){a.stopPropagation(),a.preventDefault(),h.toggleTab(c)})):(a.setAttribute('disabled','disabled'),a.classList.add('disabled'),a.classList.remove('active'),'continue')},b=this,(c=0,f=this.element.querySelectorAll('[data-tab-toggle]'));c<f.length;c++)g=f[c],a(g);return[2]})})},a.prototype.togglePane=function(){return c(this,void 0,void 0,function(){return d(this,function(){return this.displayed?(this.element.classList.add('contextual-collapsed'),document.body.classList.remove('calista-body-with-pane'),this.displayed=!1,this.state.hide()):(this.element.classList.remove('contextual-collapsed'),document.body.classList.add('calista-body-with-pane'),this.displayed=!0,this.state.show()),[2]})})},a.prototype.toggleTab=function(a){return c(this,void 0,void 0,function(){var b,c,e,f;return d(this,function(){for(console.log('contextual pane: toggled tab: '+a),b=null,(c=0,e=this.tabs);c<e.length;c++)f=e[c],f.name===a?b=f:(f.element.classList.remove('active'),f.linkElement.classList.remove('active'));return b?(b.element.classList.add('active'),b.linkElement.classList.add('active')):console.log('contextual pane: could not find tab: '+a),[2]})})},a}();b.Pane=g},function(a,b){'use strict';function c(a){if(''===a)return{};var b=a.indexOf('?');if(-1!==b)a=a.substr(b+1);else return{};var c={};return a.split('&').forEach(function(a){var b=a.indexOf('=');if(-1===b)c[a]='';else{var d=a.substr(0,b),e=a.substr(b+1);c[d]=decodeURIComponent(e.replace(/\+/g,' '))}}),c}function d(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+'='+encodeURIComponent(a[c]));return b.join('&')}function e(a,b,c){void 0===c&&(c=!1);var d;return function(){var e=this,f=arguments,g=c&&!d;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),g&&a.apply(e,f)}}var f=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d['throw'](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},g=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError('Generator is already executing.');for(;g;)try{if(e=1,f&&(h=f[2&c[0]?'return':c[0]?'throw':'next'])&&!(h=h.call(f,c[1])).done)return h;switch((f=0,h)&&(c=[0,h.value]),c[0]){case 0:case 1:h=c;break;case 4:return g.label++,{value:c[1],done:!1};case 5:g.label++,f=c[1],c=[0];continue;case 7:c=g.ops.pop(),g.trys.pop();continue;default:if((h=g.trys,!(h=0<h.length&&h[h.length-1]))&&(6===c[0]||2===c[0])){g=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3])){g.label=c[1];break}if(6===c[0]&&g.label<h[1]){g.label=h[1],h=c;break}if(h&&g.label<h[2]){g.label=h[2],g.ops.push(c);break}h[2]&&g.ops.pop(),g.trys.pop();continue;}c=b.call(a,g)}catch(a){c=[6,a],f=0}finally{e=h=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,h,i,g={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},'function'==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(b,'__esModule',{value:!0});var h=function(){function a(a){if(this.ajaxOnly=!1,this.baseUrl='/',this.refreshing=!1,this.element=a,this.element.setAttribute('data-page-initialized','1'),a.hasAttribute('data-page-query')){var b=a.getAttribute('data-page-query');try{this.query=JSON.parse(b)}catch(a){console.log('invalid JSON: '+b),this.query={}}}this.route=a.getAttribute('data-page-route'),this.id=a.getAttribute('data-page'),this.viewType=a.getAttribute('data-view-type'),this.searchParam=a.getAttribute('data-page-search'),this.ajaxOnly=a.hasAttribute('data-ajax-only'),this.modal=document.createElement('div'),this.modal.setAttribute('class','page-modal'),this.element.insertBefore(this.modal,this.element.firstChild),this.attachBehaviors(!1)}return a.prototype.request=function(a,b){var c=this;return new Promise(function(e,f){var g=new XMLHttpRequest;g.open('GET',c.baseUrl+a+'?'+d(b)),g.setRequestHeader('X-Requested-With','XMLHttpRequest'),g.addEventListener('load',function(){200===this.status?e(g):f(this.status+': '+this.statusText)}),g.addEventListener('error',function(){f(this.status+': '+this.statusText)}),g.send()})},a.prototype.placePageBlocks=function(a){if(a.query&&(this.query=a.query),a.blocks)for(var b in a.blocks){for(var c,d=0,e=0,f=this.element.querySelectorAll('[data-page-block='+b+']');e<f.length;e++)c=f[e],c.innerHTML=a.blocks[b],d++;d?(1<d&&console.log('Warning, block '+b+' exists more than once in page'),this.attachBehaviors(!0)):console.log('Warning, block '+b+' does not exists in page')}},a.prototype.reload=function(a,b){b&&console.log(b),window.location.href=a},a.prototype.modalSpawn=function(){this.modal.classList.add('loading')},a.prototype.modalDestroy=function(){this.modal.classList.remove('loading')},a.prototype.refreshPage=function(a,b){return void 0===b&&(b=!1),f(this,void 0,void 0,function(){var c,e,f,f,h=this;return g(this,function(){if(this.refreshing)return[2];if(this.refreshing=!0,c=location.pathname+'?'+d(a),'twig_form_page'===this.viewType)return this.reload(c),[2];if(this.modalSpawn(),e={},e._page_id=this.id,e._route=this.route,!b)for(f in this.query)e[f]=this.query[f];if(a)for(f in a)e[f]=a[f];return this.request('admin/calista/refresh',e).then(function(a){var b=JSON.parse(a.responseText);if(!b)throw a.status+': '+a.statusText+': got invalid response data';h.placePageBlocks(b),h.refreshing=!1,h.modalDestroy()},function(a){h.reload(c,a)}).catch(function(a){h.reload(c,a)}),[2]})})},a.prototype.attachBehaviors=function(a){var b=this,d=this;a&&Drupal.attachBehaviors(this.element);for(var f,g=function(a){a.addEventListener('click',function(b){b.stopPropagation(),b.preventDefault(),d.refreshPage(c(a.getAttribute('href')||''),!0)})},h=0,i=this.element.querySelectorAll('[data-page-link]');h<i.length;h++)f=i[h],g(f);var j=this.element.querySelector('form.calista-search-form');if(j){var k=j.querySelector('input[type=text]');if(k){var l=e(function(){var a={};a[b.searchParam||'s']=k.value,b.refreshPage(a)},500);k.addEventListener('keydown',l),k.addEventListener('keypress',l),k.addEventListener('change',l)}j.addEventListener('submit',function(a){if(a.stopPropagation(),a.preventDefault(),k){var c={};c[b.searchParam||'s']=k.value,b.refreshPage(c)}})}var m=this.element.querySelector('[data-page-checkbox="all"]');if(m){var n=this.element.querySelectorAll('table input:checkbox');n.length&&m.addEventListener('click',function(a){a.stopPropagation();for(var b,c=0,d=n;c<d.length;c++)b=d[c],b.checked=m.checked})}},a}();b.Page=h}]);